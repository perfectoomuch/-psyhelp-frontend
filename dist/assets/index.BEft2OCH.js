var $=Object.defineProperty;var L=(t,e,s)=>e in t?$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var S=(t,e,s)=>L(t,typeof e!="symbol"?e+"":e,s);import{_ as I}from"./Header.vue_vue_type_script_setup_true_lang.D0OF80CJ.js";import{B as T,a as N,S as Q}from"./SpecialistsLoop.DJHq299k.js";import{d as U,h as f,_ as x,Q as D,I as H,X as A,c as p,o as i,b as r,g as j,j as E,r as a,F as d,i as h,f as _,w as l,q as g,t as w,l as G,e as M,p as P,u as X}from"./index.CY1TeMWG.js";import{_ as z,a as J,b as K,c as O,d as R,e as W,f as Y}from"./SelectValue.vue_vue_type_script_setup_true_lang.DMi1Ysju.js";import"./specialist.B1-3R11H.js";import"./emitUp.BKutWrD2.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang.DoyR2h-P.js";import"./utils.BQ_vfMpE.js";import"./useTypeahead.kq2uD7pL.js";import"./index.BcbM7Xef.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang.DgG1nC5z.js";import"./MaterializeDatepicker.C7JoDENO.js";import"./VueStarRating.common.DRVsqd6R.js";import"./PaginationPrevious.vue_vue_type_script_setup_true_lang.BQUgCz98.js";const m=U("specialists",{state:()=>({specialists:[],loading:!0}),actions:{setSpecialists(t){this.specialists=t,this.loading=!1}}});class Z{constructor(){S(this,"store",m())}async fetchSpecialists(){try{const e=await f.get("specialists");this.store.setSpecialists(e.data)}catch(e){console.log(e)}}async fetchSpecialistsByFilter(e){try{const s=await f.post("specialists/filter-by-bid",e);this.store.setSpecialists(s.data)}catch(s){console.log(s)}}}const ee={components:{Header:I,SpecialistsLoop:Q,X:A,Info:H,Booking:N,Select:Y,SelectContent:W,SelectGroup:R,SelectItem:O,SelectLabel:K,SelectTrigger:J,SelectValue:z},data:()=>({specialistsService:new Z,bidService:new T,questionsService:new D,afterFilterForm:[],filterFormShow:!1,search:""}),async created(){await this.questionsService.fetchQuestions(),await Promise.all(this.questionsStore.filters.map(t=>{this.afterFilterForm.push({local_id:t.id,question:t.question,answer:"",field:t.field})})),this.specialistsStore.specialists.length===0&&await this.specialistsService.fetchSpecialists(),this.filterFormShow=!0},computed:{specialistsStore(){const t=m();return this.search.trim().length>0?{specialists:t.specialists.filter(e=>e.id===this.search),loading:t.loading}:m()},userStore(){return X()},questionsStore(){return P()}},methods:{async onBooking(t){const e={...t,chat_id:this.userStore.user.chat_id};return await this.bidService.createBid(e)},async onChangeFilter(){const t=this.afterFilterForm.map(e=>Array.isArray(e.answer)?e:typeof e.answer=="string"?{...e,answer:e.answer.length>0?[e.answer]:[""]}:e);await this.specialistsService.fetchSpecialistsByFilter(t),window.scrollTo({top:0,behavior:"auto"})}}},te={key:0,class:"grid grid-cols-2 gap-2 mb-4"};function se(t,e,s,ae,ie,c){const y=a("Header"),F=a("SelectValue"),b=a("SelectTrigger"),v=a("SelectLabel"),V=a("SelectItem"),B=a("SelectContent"),q=a("Select"),k=a("SpecialistsLoop");return i(),p(d,null,[r(y,{title:"Все специалисты",description:"Полный каталог всех психологов"}),t.filterFormShow?(i(),p("div",te,[(i(!0),p(d,null,h(c.questionsStore.filters,(o,u)=>(i(),_(q,{key:u,modelValue:t.afterFilterForm[u].answer,"onUpdate:modelValue":[n=>t.afterFilterForm[u].answer=n,c.onChangeFilter]},{default:l(()=>[r(b,{class:"bg-white border-none shadow-md w-full"},{default:l(()=>[r(F,{placeholder:o.question},null,8,["placeholder"])]),_:2},1024),r(B,{class:"bg-white border-gray-200 max-h-[400px]"},{default:l(()=>[r(v,null,{default:l(()=>[g(w(o.question),1)]),_:2},1024),(i(!0),p(d,null,h(o.variants,(n,C)=>(i(),_(V,{key:C,value:n},{default:l(()=>[g(w(n),1)]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"]))),128))])):j("",!0),E(M("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>t.search=o),type:"text",class:"input w-full mb-4 bg-white shadow-sm",placeholder:"Поиск по ID специалиста"},null,512),[[G,t.search]]),r(k,{specialists:c.specialistsStore.specialists,loading:c.specialistsStore.loading},null,8,["specialists","loading"])],64)}const ye=x(ee,[["render",se]]);export{ye as default};
