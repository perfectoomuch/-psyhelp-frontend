import{a as w,g as h,o as a,w as o,D as S,B as d,A as B,b as l,f as s,X as U,c as i,n as q,_ as G,a1 as K,e as b,G as X,k as J,r as p,O as Q,F as g,i as D,j as _,t as r,a2 as W}from"./index-CqT2QNuy.js";import{_ as Z,a as ee,b as se,c as te,d as ne,e as le,f as ae,g as oe,h as re,i as ie,j as de}from"./PopoverTrigger.vue_vue_type_script_setup_true_lang-Cfpa6dAJ.js";import{e as A,r as C,f as $,g as ue,a as pe}from"./utils-B0VsVXUT.js";import{_ as ce,a as me,b as fe,c as be,d as ge,e as _e}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-0bR7uDRE.js";const he=[{value:"in_agreement",name:"В согласовании"},{value:"cancelled",name:"Отменено"},{value:"confirmed",name:"Подтверждено"}],ve=t=>{switch(t){case"in_agreement":return"В согласовании";case"cancelled":return"Отменено";case"confirmed":return"Подтверждено"}},ye=w({__name:"Sheet",props:{open:{type:Boolean},defaultOpen:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(t,{emit:e}){const v=A(t,e);return(c,f)=>(a(),h(d(Z),S({"data-slot":"sheet"},d(v)),{default:o(()=>[B(c.$slots,"default")]),_:3},16))}}),we=w({__name:"SheetOverlay",props:{forceMount:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(t){const e=t,u=C(e,"class");return(m,v)=>(a(),h(d(ee),S({"data-slot":"sheet-overlay",class:d($)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80",e.class)},d(u)),{default:o(()=>[B(m.$slots,"default")]),_:3},16,["class"]))}}),Be=w({inheritAttrs:!1,__name:"SheetContent",props:{class:{},side:{default:"right"},forceMount:{type:Boolean},trapFocus:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(t,{emit:e}){const u=t,m=e,v=C(u,"class","side"),c=A(v,m);return(f,M)=>(a(),h(d(se),null,{default:o(()=>[l(we),l(d(ne),S({"data-slot":"sheet-content",class:d($)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",f.side==="right"&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm",f.side==="left"&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",f.side==="top"&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",f.side==="bottom"&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",u.class)},{...d(c),...f.$attrs}),{default:o(()=>[B(f.$slots,"default"),l(d(te),{class:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none"},{default:o(()=>[l(d(U),{class:"size-4"}),M[0]||(M[0]=s("span",{class:"sr-only"},"Close",-1))]),_:1,__:[0]})]),_:3},16,["class"])]),_:3}))}}),Se=w({__name:"SheetDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(t){const e=t,u=C(e,"class");return(m,v)=>(a(),h(d(le),S({"data-slot":"sheet-description",class:d($)("text-muted-foreground text-sm",e.class)},d(u)),{default:o(()=>[B(m.$slots,"default")]),_:3},16,["class"]))}}),De=w({__name:"SheetHeader",props:{class:{}},setup(t){const e=t;return(u,m)=>(a(),i("div",{"data-slot":"sheet-header",class:q(d($)("flex flex-col gap-1.5 p-4",e.class))},[B(u.$slots,"default")],2))}}),$e=w({__name:"SheetTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(t){const e=t,u=C(e,"class");return(m,v)=>(a(),h(d(ae),S({"data-slot":"sheet-title",class:d($)("text-foreground font-semibold",e.class)},d(u)),{default:o(()=>[B(m.$slots,"default")]),_:3},16,["class"]))}}),Me=w({__name:"SheetTrigger",props:{asChild:{type:Boolean},as:{}},setup(t){const e=t;return(u,m)=>(a(),h(d(oe),S({"data-slot":"sheet-trigger"},e),{default:o(()=>[B(u.$slots,"default")]),_:3},16))}}),ke={components:{Popover:de,PopoverContent:ie,PopoverTrigger:re,DropdownMenu:_e,DropdownMenuContent:ge,DropdownMenuItem:be,DropdownMenuLabel:fe,DropdownMenuSeparator:me,DropdownMenuTrigger:ce,Sheet:ye,SheetContent:Be,SheetDescription:Se,SheetHeader:De,SheetTitle:$e,SheetTrigger:Me},data:()=>({bidService:new K,loading:!0,bids:[],search:{text:"",used:!1,result:""},currentBid:null,drawerOpen:!1,drawerLoading:!0,getProfession:pe,getRoute:ue,getStatus:ve,getStatusList:he}),async created(){await this.getAll()},computed:{methodStore(){return W()},bidsMap(){return this.search.used?this.search.result:this.bids}},methods:{async getAll(){this.bids=await this.bidService.getAll(),this.loading=!1},async updateBidStatusById(t,e){var u;await this.bidService.updateStatusById(t,e),await this.getAll(),t===((u=this.currentBid)==null?void 0:u.id)&&await this.openBid(t)},async openBid(t){this.drawerOpen=!0,this.drawerLoading=!0,this.currentBid=await this.bidService.getById(t),this.drawerLoading=!1},async onSearch(){if(this.search.text.trim().length===0){this.search.result=[],this.search.used=!1;return}this.search.result=await this.bidService.getBySearch(this.search.text),this.search.used=!0}}},Ce={class:"flex justify-between"},Pe={class:"input border"},xe={key:0,class:"flex justify-center"},Ie={key:1,role:"alert",class:"alert"},Te={key:2,class:"overflow-x-auto"},Le={class:"table table-sm"},Oe={class:"text-xs opacity-55"},je={class:"whitespace-nowrap text-primary cursor-pointer"},Ye={class:"grid gap-4"},ze={class:"space-y-2"},Ae={class:"text-sm font-medium leading-none"},He={class:"grid gap-2"},Ee={class:"grid grid-cols-3 items-center gap-4 text-xs"},Fe={class:"col-span-2"},Ve={class:"col-span-2 text-primary"},Ne=["href"],Re={class:"col-span-2"},Ue={class:"whitespace-nowrap text-primary cursor-pointer"},qe={class:"grid gap-4"},Ge={class:"space-y-2"},Ke={class:"text-sm font-medium leading-none"},Xe={class:"grid gap-2"},Je=["src"],Qe={class:"grid grid-cols-3 items-center gap-4 text-sm"},We={class:"col-span-2"},Ze={class:"col-span-2"},es={class:"col-span-2"},ss={class:"col-span-2"},ts={class:"whitespace-nowrap flex items-center gap-2"},ns=["onClick"],ls={key:0,class:"flex items-center justify-center flex-1"},as={class:"px-4 pb-4 flex flex-col gap-4 w-full"},os={class:"fieldset bg-base-200 border-base-300 rounded-box border p-4"},rs=["value"],is=["value"],ds={class:"relative"},us=["value"],ps={key:0,class:"fieldset bg-base-200 border-base-300 rounded-box border p-4"},cs={class:"label"},ms=["value"],fs={class:"fieldset bg-base-200 border-base-300 rounded-box border p-4"},bs=["value"],gs=["value"],_s=["value"],hs={class:"fieldset bg-base-200 border-base-300 rounded-box border p-4"},vs=["src"],ys=["value"],ws=["value"],Bs=["value"],Ss=["value"],Ds=["value"],$s=["value"],Ms={key:1},ks={key:2},Cs=["value"],Ps=["value"],xs=["value"],Is=["value"],Ts=["value"],Ls=["value"];function Os(t,e,u,m,v,c){const f=p("Icon"),M=p("Info"),P=p("PopoverTrigger"),x=p("PopoverContent"),I=p("Popover"),T=p("DropdownMenuTrigger"),L=p("DropdownMenuLabel"),O=p("DropdownMenuSeparator"),j=p("DropdownMenuItem"),Y=p("DropdownMenuContent"),z=p("DropdownMenu"),H=p("SheetTitle"),E=p("SheetDescription"),F=p("SheetHeader"),V=p("SheetContent"),N=p("Sheet");return a(),i(g,null,[s("div",Ce,[e[4]||(e[4]=s("h1",{class:"text-2xl font-semibold mb-10"},"Все заявки",-1)),s("form",{onSubmit:e[1]||(e[1]=X((...n)=>c.onSearch&&c.onSearch(...n),["prevent"])),class:"flex gap-2"},[s("label",Pe,[l(f,{name:"Search",size:16}),J(s("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>t.search.text=n),type:"text",class:"grow",placeholder:"id, email, username"},null,512),[[Q,t.search.text]])]),e[3]||(e[3]=s("button",{class:"btn"},"Поиск",-1))],32)]),t.loading?(a(),i("div",xe,e[5]||(e[5]=[s("span",{class:"loading loading-spinner text-primary"},null,-1)]))):b("",!0),!t.loading&&c.bidsMap.length===0?(a(),i("div",Ie,[l(M,{class:"min-size-4 text-primary"}),e[6]||(e[6]=s("span",null,"На данный момент нет заявок. Вернитесь позже",-1))])):b("",!0),!t.loading&&c.bidsMap.length>0?(a(),i("div",Te,[s("table",Le,[e[20]||(e[20]=s("thead",null,[s("tr",null,[s("th",{class:"font-medium"},"Создано"),s("th",{class:"font-medium"},"Клиент"),s("th",{class:"font-medium"},"Специалист"),s("th",{class:"font-medium"},"Желаемая дата"),s("th",{class:"font-medium"},"Статус"),s("th",{class:"font-medium"},"Детали заявки")])],-1)),s("tbody",null,[(a(!0),i(g,null,D(c.bidsMap,(n,y)=>(a(),i("tr",{key:y},[s("td",null,[_(r(t.$dayjs(n.created_at).format("DD-MM-YYYY HH:mm:ss"))+" ",1),e[7]||(e[7]=s("br",null,null,-1)),s("span",Oe,r(n.id),1)]),s("td",null,[l(I,null,{default:o(()=>[l(P,{"as-child":""},{default:o(()=>[s("span",je,r(n.customer.first_name)+" "+r(n.customer.last_name),1)]),_:2},1024),l(x,{class:"w-80"},{default:o(()=>[s("div",Ye,[s("div",ze,[s("h4",Ae," ID: "+r(n.customer.id),1),e[8]||(e[8]=s("p",{class:"text-sm text-muted-foreground"}," Информация о клиенте ",-1))]),s("div",He,[s("div",Ee,[e[10]||(e[10]=s("span",null,"Email",-1)),s("span",Fe,r(n.customer.email),1),n.customer.username?(a(),i(g,{key:0},[e[9]||(e[9]=s("span",null,"Username",-1)),s("span",Ve,[s("a",{href:`https://t.me/${n.customer.username}`}," @"+r(n.customer.username),9,Ne)])],64)):b("",!0),e[11]||(e[11]=s("span",null,"Chat ID",-1)),s("span",Re,r(n.customer.chat_id),1)])]),e[12]||(e[12]=s("button",{class:"btn w-full btn-primary"}," Отправить сообщение ",-1))])]),_:2},1024)]),_:2},1024)]),s("td",null,[l(I,null,{default:o(()=>[l(P,{"as-child":""},{default:o(()=>[s("span",Ue,r(n.specialist.first_name)+" "+r(n.specialist.last_name),1)]),_:2},1024),l(x,{class:"w-80"},{default:o(()=>[s("div",qe,[s("div",Ge,[s("h4",Ke," ID: "+r(n.specialist.id),1),e[13]||(e[13]=s("p",{class:"text-sm text-muted-foreground"}," Информация о специалисте ",-1))]),s("div",Xe,[n.specialist.photo?(a(),i("img",{key:0,src:t.$file(n.specialist.photo),alt:"",class:"w-[90px] h-[90px] rounded-lg mb-2"},null,8,Je)):b("",!0),s("div",Qe,[e[14]||(e[14]=s("span",null,"Email",-1)),s("span",We,r(n.specialist.email),1),e[15]||(e[15]=s("span",null,"Профессия",-1)),s("span",Ze,r(t.getProfession(n.specialist.profession)),1),e[16]||(e[16]=s("span",null,"Направлении",-1)),s("span",es,r(t.getRoute(n.specialist.experience_route)),1),e[17]||(e[17]=s("span",null,"Цена",-1)),s("span",ss,r(t.$currency(n.specialist.price)),1)])]),e[18]||(e[18]=s("button",{class:"btn w-full btn-primary"}," Открыть профиль ",-1))])]),_:2},1024)]),_:2},1024)]),s("td",null,r(n.date),1),s("td",null,[l(z,null,{default:o(()=>[l(T,null,{default:o(()=>[s("span",ts,[_(r(t.getStatus(n.status))+" ",1),l(f,{name:"ChevronDown",size:14})])]),_:2},1024),l(Y,null,{default:o(()=>[l(L,{class:"text-sm"},{default:o(()=>e[19]||(e[19]=[_(" Изменить статус ")])),_:1,__:[19]}),l(O),(a(!0),i(g,null,D(t.getStatusList,(k,R)=>(a(),h(j,{key:R,class:"hover:bg-gray-100",onClick:js=>c.updateBidStatusById(n.id,k.value)},{default:o(()=>[_(r(k.name),1)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),_:2},1024)]),s("td",null,[s("button",{class:"btn btn-sm w-full",onClick:k=>c.openBid(n.id)}," Открыть ",8,ns)])]))),128))])])])):b("",!0),l(N,{open:t.drawerOpen,"onUpdate:open":e[2]||(e[2]=n=>t.drawerOpen=n)},{default:o(()=>[l(V,{class:"overflow-y-scroll flex flex-col"},{default:o(()=>[t.drawerLoading?(a(),i("div",ls,e[21]||(e[21]=[s("span",{class:"loading loading-spinner text-primary"},null,-1)]))):b("",!0),!t.drawerLoading&&t.currentBid!==null?(a(),i(g,{key:1},[l(F,null,{default:o(()=>[l(H,{class:"leading-none"},{default:o(()=>[_(" ID: "+r(t.currentBid.id),1)]),_:1}),l(E,null,{default:o(()=>e[22]||(e[22]=[_("Заявка на сессию")])),_:1,__:[22]})]),_:1}),s("div",as,[s("fieldset",os,[e[24]||(e[24]=s("legend",{class:"fieldset-legend"},"Детали заявки",-1)),e[25]||(e[25]=s("label",{class:"label"},"Создано",-1)),s("input",{class:"input border",value:t.$dayjs(t.currentBid.created_at).format("DD-MM-YYYY HH:mm:ss"),readonly:""},null,8,rs),e[26]||(e[26]=s("label",{class:"label"},"Желаемая дата на сессию",-1)),s("input",{class:"input border",value:t.currentBid.date,readonly:""},null,8,is),e[27]||(e[27]=s("label",{class:"label"},"Статус",-1)),s("div",ds,[s("input",{class:"input border",value:t.getStatus(t.currentBid.status),readonly:""},null,8,us),l(z,null,{default:o(()=>[l(T,{class:"btn btn-sm btn-square absolute top-1/2 right-2",style:{transform:"translateY(-50%) !important"}},{default:o(()=>[l(f,{name:"ChevronDown",size:16})]),_:1}),l(Y,{side:"bottom",align:"end"},{default:o(()=>[l(L,{class:"text-sm"},{default:o(()=>e[23]||(e[23]=[_(" Изменить статус ")])),_:1,__:[23]}),l(O),(a(!0),i(g,null,D(t.getStatusList,(n,y)=>(a(),h(j,{key:y,class:"hover:bg-gray-100",onClick:k=>c.updateBidStatusById(t.currentBid.id,n.value)},{default:o(()=>[_(r(n.name),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),e[28]||(e[28]=s("button",{class:"btn btn-accent"},"Выставить счет на оплату",-1))]),t.currentBid.body.length>0?(a(),i("fieldset",ps,[e[29]||(e[29]=s("legend",{class:"fieldset-legend"},"Опрос",-1)),(a(!0),i(g,null,D(t.currentBid.body,(n,y)=>(a(),i(g,{key:y},[s("label",cs,r(n.question),1),s("input",{class:"input border",value:n.answer.join(", "),readonly:""},null,8,ms)],64))),128))])):b("",!0),s("fieldset",fs,[e[30]||(e[30]=s("legend",{class:"fieldset-legend"},"Клиент",-1)),e[31]||(e[31]=s("label",{class:"label"},"Имя",-1)),s("input",{class:"input border",value:t.currentBid.customer.first_name,readonly:""},null,8,bs),e[32]||(e[32]=s("label",{class:"label"},"Фамилия",-1)),s("input",{class:"input border",value:t.currentBid.customer.last_name,readonly:""},null,8,gs),e[33]||(e[33]=s("label",{class:"label"},"Email",-1)),s("input",{class:"input border",value:t.currentBid.customer.email},null,8,_s),e[34]||(e[34]=s("button",{class:"btn btn-primary"},"Написать сообщение",-1))]),s("fieldset",hs,[e[35]||(e[35]=s("legend",{class:"fieldset-legend"},"Специалист",-1)),t.currentBid.specialist.photo?(a(),i("img",{key:0,src:t.$file(t.currentBid.specialist.photo),alt:"",class:"w-[100px] h-[100px] object-cover rounded-lg mb-2"},null,8,vs)):b("",!0),e[36]||(e[36]=s("label",{class:"label"},"Имя",-1)),s("input",{class:"input border",value:t.currentBid.specialist.first_name,readonly:""},null,8,ys),e[37]||(e[37]=s("label",{class:"label"},"Фамилия",-1)),s("input",{class:"input border",value:t.currentBid.specialist.last_name,readonly:""},null,8,ws),e[38]||(e[38]=s("label",{class:"label"},"Email",-1)),s("input",{class:"input border",value:t.currentBid.specialist.email},null,8,Bs),e[39]||(e[39]=s("label",{class:"label"},"Профессия",-1)),s("input",{class:"input border",value:t.getProfession(t.currentBid.specialist.profession)},null,8,Ss),e[40]||(e[40]=s("label",{class:"label"},"Направлении",-1)),s("input",{class:"input border",value:t.getRoute(t.currentBid.specialist.experience_route)},null,8,Ds),e[41]||(e[41]=s("label",{class:"label"},"Цена",-1)),s("input",{class:"input border",value:t.$currency(t.currentBid.specialist.price)},null,8,$s),e[42]||(e[42]=s("label",{class:"label"},"Методы",-1)),t.currentBid.specialist.methods.length>0?(a(),i("ul",Ms,[(a(!0),i(g,null,D(t.currentBid.specialist.methods,(n,y)=>(a(),i("li",{key:y},r(c.methodStore.getMethod(n).name),1))),128))])):(a(),i("span",ks,"Не указан")),e[43]||(e[43]=s("label",{class:"label"},"Опыт работы в годах",-1)),s("input",{class:"input border",value:t.currentBid.specialist.experience_years},null,8,Cs),e[44]||(e[44]=s("label",{class:"label"},"Возраст в годах",-1)),s("input",{class:"input border",value:t.currentBid.specialist.age},null,8,Ps),e[45]||(e[45]=s("label",{class:"label"},"Описание профиля",-1)),s("input",{class:"input border",value:t.currentBid.specialist.message},null,8,xs),e[46]||(e[46]=s("label",{class:"label"},"Образования",-1)),s("input",{class:"input border",value:t.currentBid.specialist.education},null,8,Is),e[47]||(e[47]=s("label",{class:"label"},"Сессии было",-1)),s("input",{class:"input border",value:t.currentBid.specialist.sessions},null,8,Ts),e[48]||(e[48]=s("label",{class:"label"},"Опыт работы с этническими группами",-1)),s("input",{class:"input border",value:t.currentBid.specialist.experience_ethnic_group==="yes"?"Да":"Нет"},null,8,Ls)])])],64)):b("",!0)]),_:1})]),_:1},8,["open"])],64)}const Es=G(ke,[["render",Os]]);export{Es as default};
