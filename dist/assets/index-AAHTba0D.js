var $=Object.defineProperty;var L=(t,e,s)=>e in t?$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var d=(t,e,s)=>L(t,typeof e!="symbol"?e+"":e,s);import{_ as I}from"./Header.vue_vue_type_script_setup_true_lang-DKtXpEjR.js";import{B as T,a as Q,S as x}from"./SpecialistsLoop-BLRmd_Al.js";import{d as H,h as S,_ as N,Q as U,I as A,X as D,c as n,o as i,b as r,g as E,r as a,F as m,i as f,f as _,w as o,q as h,t as g,p as G,u as P}from"./index-BeL3-aS9.js";import{_ as X,a as j,b as z,c as J,d as K,e as M,f as O}from"./SelectValue.vue_vue_type_script_setup_true_lang-BSKdQVPr.js";import"./specialist-B1-3R11H.js";import"./emitUp-BKutWrD2.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-CH8885Tq.js";import"./utils-SVaxs_O8.js";import"./useTypeahead-D2N8t_hs.js";import"./index-BwWeqr07.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-CF3HXNgN.js";import"./MaterializeDatepicker-BRVX2R88.js";import"./VueStarRating.common-CtRaXckU.js";import"./PaginationPrevious.vue_vue_type_script_setup_true_lang-D6lPmlUH.js";const w=H("specialists",{state:()=>({specialists:[],loading:!0}),actions:{setSpecialists(t){this.specialists=t,this.loading=!1}}});class R{constructor(){d(this,"store",w())}async fetchSpecialists(){try{const e=await S.get("specialists");this.store.setSpecialists(e.data)}catch(e){console.log(e)}}async fetchSpecialistsByFilter(e){try{const s=await S.post("specialists/filter-by-bid",e);this.store.setSpecialists(s.data)}catch(s){console.log(s)}}}const W={components:{Header:I,SpecialistsLoop:x,X:D,Info:A,Booking:Q,Select:O,SelectContent:M,SelectGroup:K,SelectItem:J,SelectLabel:z,SelectTrigger:j,SelectValue:X},data:()=>({specialistsService:new R,bidService:new T,questionsService:new U,afterFilterForm:[],filterFormShow:!1}),async created(){await this.questionsService.fetchQuestions(),await Promise.all(this.questionsStore.filters.map(t=>{this.afterFilterForm.push({local_id:t.id,question:t.question,answer:"",field:t.field})})),this.specialistsStore.specialists.length===0&&await this.specialistsService.fetchSpecialists(),this.filterFormShow=!0},computed:{specialistsStore(){return w()},userStore(){return P()},questionsStore(){return G()}},methods:{async onBooking(t){const e={...t,chat_id:this.userStore.user.chat_id};return await this.bidService.createBid(e)},async onChangeFilter(){const t=this.afterFilterForm.map(e=>Array.isArray(e.answer)?e:typeof e.answer=="string"?{...e,answer:e.answer.length>0?[e.answer]:[""]}:e);await this.specialistsService.fetchSpecialistsByFilter(t),window.scrollTo({top:0,behavior:"auto"})}}},Y={key:0,class:"grid grid-cols-2 gap-2 mb-4"};function Z(t,e,s,ee,te,c){const y=a("Header"),F=a("SelectValue"),b=a("SelectTrigger"),v=a("SelectLabel"),q=a("SelectItem"),B=a("SelectContent"),V=a("Select"),k=a("SpecialistsLoop");return i(),n(m,null,[r(y,{title:"Все специалисты",description:"Полный каталог всех психологов"}),t.filterFormShow?(i(),n("div",Y,[(i(!0),n(m,null,f(c.questionsStore.filters,(p,u)=>(i(),_(V,{key:u,modelValue:t.afterFilterForm[u].answer,"onUpdate:modelValue":[l=>t.afterFilterForm[u].answer=l,c.onChangeFilter]},{default:o(()=>[r(b,{class:"bg-white border-none shadow-md w-full"},{default:o(()=>[r(F,{placeholder:p.question},null,8,["placeholder"])]),_:2},1024),r(B,{class:"bg-white border-gray-200 max-h-[400px]"},{default:o(()=>[r(v,null,{default:o(()=>[h(g(p.question),1)]),_:2},1024),(i(!0),n(m,null,f(p.variants,(l,C)=>(i(),_(q,{key:C,value:l},{default:o(()=>[h(g(l),1)]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"]))),128))])):E("",!0),r(k,{specialists:c.specialistsStore.specialists,loading:c.specialistsStore.loading},null,8,["specialists","loading"])],64)}const he=N(W,[["render",Z]]);export{he as default};
