import{h as u,a4 as d,_ as g,c as r,o as a,e,g as m,J as y,b as h,j as b,r as x,l as v,F as p,i as w,t as o,q as S}from"./index.CY1TeMWG.js";class _{async getAll(){try{return(await u.get("admin/customers")).data}catch(s){return console.log(s),d.error("Непредвиденная ошибка"),[]}}async getById(s){try{return(await u.get(`admin/customers/${s}`)).data}catch(l){console.log(l),d.error("Такой заявки не существует")}}async getBySearch(s){try{return(await u.post("admin/customers/search",{search:s})).data}catch(l){console.log(l),d.error("Ошибка при поиске")}}}const k={data:()=>({customerService:new _,loading:!0,customers:[],search:{text:"",used:!1,result:[]}}),async created(){await this.getAll()},computed:{customersMap(){return this.search.used?this.search.result:this.customers}},methods:{async getAll(){this.customers=await this.customerService.getAll(),this.loading=!1},async onSearch(){if(this.search.text.trim().length===0){this.search.result=[],this.search.used=!1;return}this.search.result=await this.customerService.getBySearch(this.search.text),this.search.used=!0}}},M={class:"flex justify-between"},C={class:"input border"},B={key:0,class:"flex justify-center"},I={key:1,role:"alert",class:"alert"},$={key:2,class:"overflow-x-auto"},V={class:"table table-sm"},A=["href"],D=["href"],N={key:1},j=["onClick"];function z(n,s,l,E,F,i){const c=x("Icon");return a(),r(p,null,[e("div",M,[s[3]||(s[3]=e("h1",{class:"text-2xl font-semibold mb-10"},"Все пользователи",-1)),e("form",{onSubmit:s[1]||(s[1]=y((...t)=>i.onSearch&&i.onSearch(...t),["prevent"])),class:"flex gap-2"},[e("label",C,[h(c,{name:"Search",size:16}),b(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>n.search.text=t),type:"text",class:"grow",placeholder:"id, email, username"},null,512),[[v,n.search.text]])]),s[2]||(s[2]=e("button",{class:"btn"},"Поиск",-1))],32)]),n.loading?(a(),r("div",B,s[4]||(s[4]=[e("span",{class:"loading loading-spinner text-primary"},null,-1)]))):m("",!0),!n.loading&&i.customersMap.length===0?(a(),r("div",I,[h(c,{name:"Info",class:"min-size-4 text-primary"}),s[5]||(s[5]=e("span",null,"На данный момент нет пользователей. Вернитесь позже",-1))])):m("",!0),!n.loading&&i.customersMap.length>0?(a(),r("div",$,[e("table",V,[s[7]||(s[7]=e("thead",null,[e("tr",null,[e("th",{class:"font-medium"},"ID"),e("th",{class:"font-medium"},"Chat ID"),e("th",{class:"font-medium"},"Логин"),e("th",{class:"font-medium"},"Email"),e("th",{class:"font-medium"},"Имя и фамилия"),e("th",{class:"font-medium"})])],-1)),e("tbody",null,[(a(!0),r(p,null,w(i.customersMap,(t,f)=>(a(),r("tr",{key:f},[e("td",null,o(t.id),1),e("td",null,o(t.chat_id),1),e("td",null,[e("a",{class:"text-primary",href:`https://t.me/${t.username}`}," @"+o(t.username),9,A)]),e("td",null,[t.email?(a(),r("a",{key:0,class:"text-primary",href:`mailto:${t.email}`},o(t.email),9,D)):(a(),r("span",N,"—"))]),e("td",null,o(t.first_name)+" "+o(t.last_name),1),e("td",null,[e("button",{class:"btn btn-sm w-full",onClick:T=>n.$router.push(`/admin/dashboard/chats?customer=${t.id}`)},[h(c,{name:"MessageCircleMore",size:14}),s[6]||(s[6]=S(" Чат "))],8,j)])]))),128))])])])):m("",!0)],64)}const J=g(k,[["render",z]]);export{J as default};
