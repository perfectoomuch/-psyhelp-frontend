var $=Object.defineProperty;var L=(t,e,s)=>e in t?$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var S=(t,e,s)=>L(t,typeof e!="symbol"?e+"":e,s);import{_ as I}from"./Header.vue_vue_type_script_setup_true_lang-DtF2XRjs.js";import{B as T,_ as Q,a as x,b as H,c as N,d as U,e as A,f as j,g as D,S as E}from"./SelectValue.vue_vue_type_script_setup_true_lang-5m2u_ZGi.js";import{d as G,h as m,_ as P,Q as X,I as z,X as J,c as n,o as i,b as r,e as K,r as a,F as d,i as _,g as f,w as o,j as h,t as g,m as M,u as O}from"./index-Bl7imdDu.js";import"./utils-BdHqi6Qn.js";const w=G("specialists",{state:()=>({specialists:[],loading:!0}),actions:{setSpecialists(t){this.specialists=t,this.loading=!1}}});class R{constructor(){S(this,"store",w())}async fetchSpecialists(){try{const e=await m.get("specialists");this.store.setSpecialists(e.data)}catch(e){console.log(e)}}async fetchSpecialistsByFilter(e){try{const s=await m.post("specialists/filter-by-bid",e);this.store.setSpecialists(s.data)}catch(s){console.log(s)}}}const W={components:{Header:I,SpecialistsLoop:E,X:J,Info:z,Booking:D,Select:j,SelectContent:A,SelectGroup:U,SelectItem:N,SelectLabel:H,SelectTrigger:x,SelectValue:Q},data:()=>({specialistsService:new R,bidService:new T,questionsService:new X,afterFilterForm:[],filterFormShow:!1}),async created(){await this.questionsService.fetchQuestions(),await Promise.all(this.questionsStore.filters.map(t=>{this.afterFilterForm.push({local_id:t.id,question:t.question,answer:"",field:t.field})})),this.specialistsStore.specialists.length===0&&await this.specialistsService.fetchSpecialists(),this.filterFormShow=!0},computed:{specialistsStore(){return w()},userStore(){return O()},questionsStore(){return M()}},methods:{async onBooking(t){const e={...t,chat_id:this.userStore.user.chat_id};return await this.bidService.createBid(e)},async onChangeFilter(){const t=this.afterFilterForm.map(e=>Array.isArray(e.answer)?e:typeof e.answer=="string"?{...e,answer:e.answer.length>0?[e.answer]:[""]}:e);await this.specialistsService.fetchSpecialistsByFilter(t),window.scrollTo({top:0,behavior:"auto"})}}},Y={key:0,class:"grid grid-cols-2 gap-2 mb-4"};function Z(t,e,s,ee,te,c){const y=a("Header"),F=a("SelectValue"),b=a("SelectTrigger"),v=a("SelectLabel"),B=a("SelectItem"),V=a("SelectContent"),q=a("Select"),k=a("SpecialistsLoop");return i(),n(d,null,[r(y,{title:"Все психологи",description:"Ознакомьтесь всеми психологами на нашей платформе"}),t.filterFormShow?(i(),n("div",Y,[(i(!0),n(d,null,_(c.questionsStore.filters,(p,u)=>(i(),f(q,{key:u,modelValue:t.afterFilterForm[u].answer,"onUpdate:modelValue":[l=>t.afterFilterForm[u].answer=l,c.onChangeFilter]},{default:o(()=>[r(b,{class:"bg-white border-none shadow-md w-full"},{default:o(()=>[r(F,{placeholder:p.question},null,8,["placeholder"])]),_:2},1024),r(V,{class:"bg-white border-gray-200 max-h-[400px]"},{default:o(()=>[r(v,null,{default:o(()=>[h(g(p.question),1)]),_:2},1024),(i(!0),n(d,null,_(p.variants,(l,C)=>(i(),f(B,{key:C,value:l},{default:o(()=>[h(g(l),1)]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"]))),128))])):K("",!0),r(k,{specialists:c.specialistsStore.specialists,loading:c.specialistsStore.loading},null,8,["specialists","loading"])],64)}const ce=P(W,[["render",Z]]);export{ce as default};
