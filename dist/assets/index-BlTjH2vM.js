var $=Object.defineProperty;var L=(t,e,s)=>e in t?$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var S=(t,e,s)=>L(t,typeof e!="symbol"?e+"":e,s);import{_ as I}from"./Header.vue_vue_type_script_setup_true_lang-DNLXtvh4.js";import{B as T,a as Q,S as x}from"./SpecialistsLoop-BbahuZ0m.js";import{d as H,h as m,_ as N,Q as U,I as A,X as j,c as n,o as i,b as r,e as D,r as a,F as d,i as f,g as _,w as o,j as h,t as g,m as E,u as G}from"./index-CQO-ZVad.js";import{_ as P,a as X,b as z,c as J,d as K,e as M,f as O}from"./SelectValue.vue_vue_type_script_setup_true_lang-B9I00Usj.js";import"./utils-1WIqXIgU.js";import"./emitUp-BKutWrD2.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-BnS4hLPZ.js";import"./index-CSAZmetq.js";import"./DialogTrigger-zQ08QBNp.js";const w=H("specialists",{state:()=>({specialists:[],loading:!0}),actions:{setSpecialists(t){this.specialists=t,this.loading=!1}}});class R{constructor(){S(this,"store",w())}async fetchSpecialists(){try{const e=await m.get("specialists");this.store.setSpecialists(e.data)}catch(e){console.log(e)}}async fetchSpecialistsByFilter(e){try{const s=await m.post("specialists/filter-by-bid",e);this.store.setSpecialists(s.data)}catch(s){console.log(s)}}}const W={components:{Header:I,SpecialistsLoop:x,X:j,Info:A,Booking:Q,Select:O,SelectContent:M,SelectGroup:K,SelectItem:J,SelectLabel:z,SelectTrigger:X,SelectValue:P},data:()=>({specialistsService:new R,bidService:new T,questionsService:new U,afterFilterForm:[],filterFormShow:!1}),async created(){await this.questionsService.fetchQuestions(),await Promise.all(this.questionsStore.filters.map(t=>{this.afterFilterForm.push({local_id:t.id,question:t.question,answer:"",field:t.field})})),this.specialistsStore.specialists.length===0&&await this.specialistsService.fetchSpecialists(),this.filterFormShow=!0},computed:{specialistsStore(){return w()},userStore(){return G()},questionsStore(){return E()}},methods:{async onBooking(t){const e={...t,chat_id:this.userStore.user.chat_id};return await this.bidService.createBid(e)},async onChangeFilter(){const t=this.afterFilterForm.map(e=>Array.isArray(e.answer)?e:typeof e.answer=="string"?{...e,answer:e.answer.length>0?[e.answer]:[""]}:e);await this.specialistsService.fetchSpecialistsByFilter(t),window.scrollTo({top:0,behavior:"auto"})}}},Y={key:0,class:"grid grid-cols-2 gap-2 mb-4"};function Z(t,e,s,ee,te,c){const y=a("Header"),F=a("SelectValue"),b=a("SelectTrigger"),v=a("SelectLabel"),B=a("SelectItem"),V=a("SelectContent"),q=a("Select"),k=a("SpecialistsLoop");return i(),n(d,null,[r(y,{title:"Все психологи",description:"Ознакомьтесь всеми психологами на нашей платформе"}),t.filterFormShow?(i(),n("div",Y,[(i(!0),n(d,null,f(c.questionsStore.filters,(p,u)=>(i(),_(q,{key:u,modelValue:t.afterFilterForm[u].answer,"onUpdate:modelValue":[l=>t.afterFilterForm[u].answer=l,c.onChangeFilter]},{default:o(()=>[r(b,{class:"bg-white border-none shadow-md w-full"},{default:o(()=>[r(F,{placeholder:p.question},null,8,["placeholder"])]),_:2},1024),r(V,{class:"bg-white border-gray-200 max-h-[400px]"},{default:o(()=>[r(v,null,{default:o(()=>[h(g(p.question),1)]),_:2},1024),(i(!0),n(d,null,f(p.variants,(l,C)=>(i(),_(B,{key:C,value:l},{default:o(()=>[h(g(l),1)]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"]))),128))])):D("",!0),r(k,{specialists:c.specialistsStore.specialists,loading:c.specialistsStore.loading},null,8,["specialists","loading"])],64)}const de=N(W,[["render",Z]]);export{de as default};
