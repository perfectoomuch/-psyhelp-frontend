import{h as c,ag as u,_ as b,c as r,o as a,e,g as d,J as x,b as m,j as v,r as p,l as _,F as f,i as w,t as l,q as S}from"./index-DlouWDH6.js";class k{async getAll(){try{return(await c.get("admin/customers")).data}catch(s){return console.log(s),u.error("Непредвиденная ошибка"),[]}}async getById(s){try{return(await c.get(`admin/customers/${s}`)).data}catch(o){console.log(o),u.error("Такой заявки не существует")}}async getBySearch(s){try{return(await c.post("admin/customers/search",{search:s})).data}catch(o){console.log(o),u.error("Ошибка при поиске")}}}const M={data:()=>({customerService:new k,loading:!0,customers:[],search:{text:"",used:!1,result:[]}}),async created(){await this.getAll()},computed:{customersMap(){return this.search.used?this.search.result:this.customers}},methods:{async getAll(){this.customers=await this.customerService.getAll(),this.loading=!1},async onSearch(){if(this.search.text.trim().length===0){this.search.result=[],this.search.used=!1;return}this.search.result=await this.customerService.getBySearch(this.search.text),this.search.used=!0}}},C={class:"flex justify-between"},I={class:"input border"},B={key:0,class:"flex justify-center"},$={key:1,role:"alert",class:"alert"},V={key:2,class:"overflow-x-auto"},A={class:"table table-sm"},D=["href"],N=["href"],j={key:1},z=["onClick"];function E(n,s,o,F,T,i){const h=p("Icon"),g=p("Info");return a(),r(f,null,[e("div",C,[s[3]||(s[3]=e("h1",{class:"text-2xl font-semibold mb-10"},"Все пользователи",-1)),e("form",{onSubmit:s[1]||(s[1]=x((...t)=>i.onSearch&&i.onSearch(...t),["prevent"])),class:"flex gap-2"},[e("label",I,[m(h,{name:"Search",size:16}),v(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>n.search.text=t),type:"text",class:"grow",placeholder:"id, email, username"},null,512),[[_,n.search.text]])]),s[2]||(s[2]=e("button",{class:"btn"},"Поиск",-1))],32)]),n.loading?(a(),r("div",B,s[4]||(s[4]=[e("span",{class:"loading loading-spinner text-primary"},null,-1)]))):d("",!0),!n.loading&&i.customersMap.length===0?(a(),r("div",$,[m(g,{class:"min-size-4 text-primary"}),s[5]||(s[5]=e("span",null,"На данный момент нет пользователей. Вернитесь позже",-1))])):d("",!0),!n.loading&&i.customersMap.length>0?(a(),r("div",V,[e("table",A,[s[7]||(s[7]=e("thead",null,[e("tr",null,[e("th",{class:"font-medium"},"ID"),e("th",{class:"font-medium"},"Chat ID"),e("th",{class:"font-medium"},"Логин"),e("th",{class:"font-medium"},"Email"),e("th",{class:"font-medium"},"Имя и фамилия"),e("th",{class:"font-medium"})])],-1)),e("tbody",null,[(a(!0),r(f,null,w(i.customersMap,(t,y)=>(a(),r("tr",{key:y},[e("td",null,l(t.id),1),e("td",null,l(t.chat_id),1),e("td",null,[e("a",{class:"text-primary",href:`https://t.me/${t.username}`}," @"+l(t.username),9,D)]),e("td",null,[t.email?(a(),r("a",{key:0,class:"text-primary",href:`mailto:${t.email}`},l(t.email),9,N)):(a(),r("span",j,"—"))]),e("td",null,l(t.first_name)+" "+l(t.last_name),1),e("td",null,[e("button",{class:"btn btn-sm w-full",onClick:q=>n.$router.push(`/admin/dashboard/chats?customer=${t.id}`)},[m(h,{name:"MessageCircleMore",size:14}),s[6]||(s[6]=S(" Чат "))],8,z)])]))),128))])])])):d("",!0)],64)}const L=b(M,[["render",E]]);export{L as default};
